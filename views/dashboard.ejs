<div class="flex">
    <a href="/dashboard" class="py-2 text-center w-[125px] text-[#075640] font-bold <%= whatif ? '' : 'border-b-2 border-[#075640]' %> hover:bg-slate-100">Academic</a>
    <a href="/dashboard?whatif=true" class="py-2 text-center w-[125px] text-[#075640] font-bold <%= whatif ? 'border-b-2 border-[#075640]' : '' %> hover:bg-slate-100">What-if</a>
</div>

<% if (!whatif) { %>

    <div class="w-full grid grid-cols-4 p-[20px]">
        <div class="flex flex-col">
            <h1 class="italic text-2xl">Degree Progress</h1>
            <div class="flex items-center justify-evenly mt-4">
                <div class="degree-completion flex justify-center items-center rounded-full max-w-[150px] max-h-[150px] h-[150px] w-[150px] mt-1">
                    <h1 class="text-xl text-center">50%<br>Complete</h1>
                </div>
                <div class="text-center text-[#075640]">
                    <h1 class="text-2xl font-bold">3.50</h1>
                    <h2 class="text-lg">Overall GPA</h2>
                </div>
            </div>
        </div>
        <div class="col-span-3 flex justify-center">
            <div class="flex w-5/6 h-[125px] bg-[#075640] rounded-lg items-center justify-between">
                <div class="flex flex-col">
                    <div class="flex gap-2 items-center text-white pl-3 pt-3">
                        <h1 class="text-4xl font-bold">Bachelor of Science</h1>
                        <h1 class="p-1 border-2 rounded-lg border-white">IN-PROGRESS</h1>
                    </div>
                    <div class="flex">

                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Script to Dynamically Update GPA -->
    <script>
        document.querySelectorAll('.grades, .credits').forEach(input => {
            input.addEventListener('input', calculateGPA);
        });

        function calculateGPA() {
            const credits = document.querySelectorAll('.credits');
            const grades = document.querySelectorAll('.grades');
            const qualityPointsFields = document.querySelectorAll('.quality-points');

            let totalQualityPoints = 0;
            let totalCredits = 0;

            credits.forEach((creditInput, index) => {
                const credit = parseFloat(creditInput.value) || 0;
                const grade = grades[index].value.toUpperCase();

                // Calculate quality points (credit hours * grade point value)
                const gradePoints = gradeToPoints(grade);
                const qualityPoints = gradePoints * credit;

                if (!isNaN(qualityPoints)) {
                    qualityPointsFields[index].value = qualityPoints.toFixed(2);
                }

                totalQualityPoints += qualityPoints;
                totalCredits += credit;
            });

            // Update total quality points and GPA hours
            document.getElementById('totalQuality').value = totalQualityPoints.toFixed(2);
            document.getElementById('totalGPAHours').value = totalCredits.toFixed(2);

            // Calculate GPA
            const gpa = totalQualityPoints / totalCredits || 0;
            document.getElementById('gpa').value = gpa.toFixed(2);
        }

        // Function to convert grade to points
        function gradeToPoints(grade) {
            switch(grade) {
                case 'A': return 4.0;
                case 'B': return 3.0;
                case 'C': return 2.0;
                case 'D': return 1.0;
                case 'F': return 0;
                default: return 0;
            }
        }
    </script>
</div>

<% } else { %>
<div class="p-[20px] flex gap-4">
    <div class="flex gap-2 items-center">
        <i class="fa-solid fa-circle-check text-[#075640]"></i>
        <h1 class="text-[#075640]">Completed</h1>
    </div>
    <div class="flex gap-2 items-center">
        <i class="fa-solid fa-circle-half-stroke text-blue-800"></i>
        <h1 class="text-[#075640]">In-progress</h1>
    </div>
</div>
<div class="p-[20px] flex justify-center text-white">
    <div class="w-11/12 bg-[#075640] rounded-lg p-4">
        <h1 class="text-2xl font-semibold">Progress</h1>
        <form action="/dashboard" method="get">
            <div class="flex gap-4 p-2">
                <div>
                    <p class="italic">Catalog Year *</p>
                    <input disabled class="px-4 py-2 w-[280px] rounded-lg border-2 border-white" value="2024-2025" />
                </div>
                <div>
                    <p class="italic">Degree *</p>
                    <input class="px-4 py-2 w-[280px] rounded-lg border-2 border-white" type="text" disabled value="<%= student.degree_type === 'BS' ? 'Bachelor Of Science' : 'Bachelor of Arts'%>" />
                </div>
            </div>
            <div class="flex gap-4 p-2">
                <div>
                    <p class="italic">Program *</p>
                    <select class="px-2 py-2 w-[280px] rounded-lg bg-[#075640] border-2 border-white truncate">
                        <option>AI, Robotics and Gaming - B.S.</option>
                        <option>Bioinformatics - B.S.</option>
                        <option>Cybersecurity - B.S.</option>
                        <option>Data Science - B.S.</option>
                        <option>Systems and Networks - B.S.</option>
                        <option>Web/Mobile Development and Software Engineering - B.S.</option>
                        <option>Human-Computer Interaction - B.A.</option>
                        <option>Information Technology - B.A.</option>
                        <option>Bioinformatics - B.A.</option>
                    </select>
                </div>
                <div>
                    <p class="italic">College *</p>
                    <input class="px-4 py-2 w-[280px] rounded-lg border-2 border-white" type="text" disabled value="Computing & Informatics" />
                </div>
            </div>
            <div class="flex p-2 justify-between items-end">
                <div>
                    <p class="italic">Level *</p>
                    <input class="px-4 py-2 w-[280px] rounded-lg border-2 border-white" type="text" disabled value="Undergraduate" />
                </div>
                <input type="submit" value="Process" class="px-2 py-1 font-semibold bg-white text-[#075640] rounded-lg hover:cursor-pointer text-xl" />
            </div>
        </form>
    </div>
</div>
<% } %>